<?xml version="1.0" encoding="UTF-8"?>
<bpmn:Microflow
    xmi:version="2.0"
    xmlns:xmi="http://www.omg.org/XMI"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:bpmn="www.MendixBPMN.com"
    name="promote employee level from Junior to Medior"
    valuedVariables="//@ownedElements.1/@newVariable //@parameters.0/@attributes.1">
  <ownedElements
      xsi:type="bpmn:StartEvent">
    <outgoingFlows
        target="create variable for expected Employee level"/>
  </ownedElements>
  <ownedElements
      xsi:type="bpmn:CreateVariable"
      incomingFlows="//@ownedElements.0/@outgoingFlows.0"
      label="create variable for expected Employee level">
    <outgoingFlows
        target="is employee level junior?"/>
    <newVariable
        xsi:type="bpmn:StringVariable"
        name="expectedLevel">
      <valueObject
          value="Junior"/>
    </newVariable>
  </ownedElements>
  <ownedElements
      xsi:type="bpmn:ForkDecision"
      incomingFlows="//@ownedElements.1/@outgoingFlows.0"
      label="is employee level junior?">
    <outgoingFlows
        constraint="true"
        target="promote employee level to Medior"/>
    <outgoingFlows
        constraint="false"
        target="show error message"/>
    <expression
        xsi:type="bpmn:StringComparisonExpression"
        operand1="//@parameters.0/@attributes.1"
        operand2="//@ownedElements.1/@newVariable"/>
  </ownedElements>
  <ownedElements
      xsi:type="bpmn:ChangeVariable"
      incomingFlows="//@ownedElements.2/@outgoingFlows.0"
      label="promote employee level to Medior"
      targetVariable="//@parameters.0/@attributes.1">
    <outgoingFlows
        target="//@ownedElements.5"/>
    <newValue
        xsi:type="bpmn:StringValue"
        value="Medior"/>
  </ownedElements>
  <ownedElements
      xsi:type="bpmn:ShowMessage"
      incomingFlows="//@ownedElements.2/@outgoingFlows.1"
      label="show error message"
      message="Promotion failed: the employee is not in Junior level">
    <outgoingFlows
        target="//@ownedElements.5"/>
  </ownedElements>
  <ownedElements
      xsi:type="bpmn:MergeDecision"
      incomingFlows="//@ownedElements.4/@outgoingFlows.0 //@ownedElements.3/@outgoingFlows.0">
    <outgoingFlows
        target="//@ownedElements.6"/>
  </ownedElements>
  <ownedElements
      xsi:type="bpmn:EndEvent"
      incomingFlows="//@ownedElements.5/@outgoingFlows.0"/>
  <parameters
      xsi:type="bpmn:Entity"
      name="Employee">
    <attributes
        xsi:type="bpmn:StringVariable"
        name="name">
      <valueObject
          value="John"/>
    </attributes>
    <attributes
        xsi:type="bpmn:StringVariable"
        name="level">
      <valueObject
          value="Junior"/>
    </attributes>
  </parameters>
</bpmn:Microflow>
